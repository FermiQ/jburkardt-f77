This documentation was auto-generated and may require manual review and enhancement.

# asa047.f

## Overview

This file `asa047.f` contains the Fortran subroutine `nelmin`, which implements the Nelder-Mead algorithm for finding the minimum of a user-supplied function of multiple variables. This is an implementation of Applied Statistics Algorithm AS 47. The file also includes the standard `timestamp` utility.

## Key Components

### Functions/Subroutines

- **Name:** `nelmin` (SUBROUTINE)
  - **Description:** Seeks to find the minimum value of a given function `fn` of `n` variables using the Nelder-Mead simplex method. The algorithm iteratively modifies a simplex (a geometric figure of n+1 vertices in n-dimensional space) by reflecting, expanding, or contracting it, moving towards the function minimum.
  - **Parameters:**
    - `fn`: (EXTERNAL FUNCTION name) The user-supplied function to be minimized. This function should take a DOUBLE PRECISION array `x` (the point) and return a DOUBLE PRECISION value (the function value at `x`).
    - `n`: (INTEGER) The number of variables (dimensions) of the function `fn`.
    - `start(n)`: (DOUBLE PRECISION array, Input/Output) On input, the initial starting point for the search. May be modified by the routine.
    - `reqmin`: (DOUBLE PRECISION) The termination criterion. The iteration stops when the variance of the function values at the simplex vertices is less than `reqmin`.
    - `step(n)`: (DOUBLE PRECISION array) Initial step sizes for each variable, used to construct the initial simplex around `start`.
    - `konvge`: (INTEGER) The number of iterations after which a convergence check is performed.
    - `kcount`: (INTEGER) The maximum allowed number of function evaluations.
  - **Output Parameters:**
    - `xmin(n)`: (DOUBLE PRECISION array) The coordinates of the point found that yields the minimum function value `ynewlo`.
    - `ynewlo`: (DOUBLE PRECISION) The minimum function value found.
    - `icount`: (INTEGER) The actual number of function evaluations performed.
    - `numres`: (INTEGER) The number of times the algorithm restarted (if a local minimum was suspected and further checks were made).
    - `ifault`: (INTEGER) Error indicator:
        - 0: No errors.
        - 1: Invalid input parameters (e.g., `reqmin` <= 0, `n` < 1, `n` > `n_max`, `konvge` < 1).
        - 2: Iteration terminated because `kcount` (max function evaluations) was exceeded without convergence, or a restart failed to improve the minimum.
  - **Returns:** [Subroutine - outputs via parameters.]

- **Name:** `timestamp` (SUBROUTINE)
  - **Description:** Prints the current system date and time in a human-readable format to standard output.
  - **Parameters:** None.
  - **Returns:** [Subroutine - writes to standard output.]

## Important Variables/Constants

- **`n_max`**: (INTEGER PARAMETER in `nelmin`)
  - **Value:** 20
  - **Purpose:** Defines the maximum number of variables (`n`) that the `nelmin` subroutine can handle due to fixed-size internal arrays (e.g., `p`, `y`, `pstar`).
- **Simplex Algorithm Parameters (in `nelmin`):**
  - `rcoeff`: (DOUBLE PRECISION PARAMETER, value 1.0D+00) Reflection coefficient.
  - `ecoeff`: (DOUBLE PRECISION PARAMETER, value 2.0D+00) Expansion coefficient.
  - `ccoeff`: (DOUBLE PRECISION PARAMETER, value 0.5D+00) Contraction coefficient.
- **Internal Arrays (in `nelmin`):**
  - `p(n_max, n_max+1)`: Stores the n-dimensional coordinates of the n+1 vertices of the simplex.
  - `y(n_max+1)`: Stores the function value `fn()` at each corresponding vertex in `p`.
  - `pbar(n_max)`: Centroid of the simplex (excluding the worst vertex).
  - `pstar(n_max)`, `p2star(n_max)`: Points generated by reflection and expansion/contraction operations.
- **`eps`**: (DOUBLE PRECISION PARAMETER in `nelmin`)
  - **Value:** 0.001D+00
  - **Purpose:** Used in factorial tests around the found minimum to check for local optimality.

## Usage Examples

```fortran
! Example of how to call nelmin:
!
!      EXTERNAL ROSENBROCK_FN ! User-defined function
!      INTEGER N_ROS, KONVGE_ROS, KCOUNT_ROS, ICOUNT_ROS, NUMRES_ROS, IFAULT_ROS
!      PARAMETER (N_ROS=2)
!      DOUBLE PRECISION START_ROS(N_ROS), XMIN_ROS(N_ROS), YNEWLO_ROS
!      DOUBLE PRECISION REQMIN_ROS, STEP_ROS(N_ROS)
!
!      ! Define Rosenbrock function or another function to minimize:
!      ! FUNCTION ROSENBROCK_FN(X)
!      !   DOUBLE PRECISION ROSENBROCK_FN, X(N_ROS)
!      !   ROSENBROCK_FN = (1.0D0 - X(1))**2 + 100.0D0 * (X(2) - X(1)**2)**2
!      !   RETURN
!      ! END
!
!      START_ROS(1) = -1.2D0
!      START_ROS(2) =  1.0D0
!
!      REQMIN_ROS = 1.0D-8
!
!      STEP_ROS(1) = 0.5D0
!      STEP_ROS(2) = 0.5D0
!
!      KONVGE_ROS = 10
!      KCOUNT_ROS = 500
!
!      CALL NELMIN ( ROSENBROCK_FN, N_ROS, START_ROS, XMIN_ROS, YNEWLO_ROS,
!     &              REQMIN_ROS, STEP_ROS, KONVGE_ROS, KCOUNT_ROS,
!     &              ICOUNT_ROS, NUMRES_ROS, IFAULT_ROS )
!
!      IF (IFAULT_ROS .EQ. 0) THEN
!        PRINT *, 'Minimum found at:', (XMIN_ROS(I), I=1,N_ROS)
!        PRINT *, 'Function value at minimum: ', YNEWLO_ROS
!      ELSE
!        PRINT *, 'NELMIN failed, IFAULT = ', IFAULT_ROS
!      END IF
!      PRINT *, 'Function evaluations: ', ICOUNT_ROS
!      PRINT *, 'Restarts: ', NUMRES_ROS
```

## Dependencies and Interactions

- **User-Supplied Function:** `nelmin` requires an external function (passed as `fn`) that evaluates the objective function to be minimized.
- **System Routine:** `DATE_AND_TIME(DATE_STR, TIME_STR)` is used by `timestamp`.
- **Intrinsic Fortran Functions:** `DBLE`.
- The parameter `n_max` limits the dimensionality of the problem.
- The file `asa047/asa047_prb.f` (not part of this core file analysis) would typically contain test programs and example objective functions.
[This section highlights the critical dependency on the user-provided function `fn`.]
